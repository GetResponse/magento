<div class="getresponse-tracking-code-section" data-bind="scope: 'getresponse_tracking_code_section'">
    <div id="customer-email-address" data-bind="attr: { 'customer-email': getResponseTrackingCode().customerEmail}"></div>
</div>

<script>
    require([
        'jquery',
        'mage/cookies',
    ], function ($) {

        $('body').on('DOMSubtreeModified', '#customer-email-address', function () {

            var customerEmail = document.getElementById('customer-email-address').getAttribute('customer-email');
            var gaIsValuable = $.cookie('gaIsValuable');
            var trackingCodeEnabled = typeof gaSetUserId !== 'undefined' && typeof gaSetUserId === 'function';

            if (customerEmail !== null && trackingCodeEnabled && gaIsValuable !== '1') {
                gaSetUserId(customerEmail);
            }
        });

        $(document).ready(function() {

            if (typeof GrViewCategoryItem !== 'undefined') {
                GrTracking('importScript', 'ec');
                GrTracking('viewCategory', GrViewCategoryItem);
            }

            if (typeof GrViewProductItem !== 'undefined') {
                GrTracking('importScript', 'ec');
                GrTracking('viewItem', GrViewProductItem);
            }
        });
    });
</script>

<script type="text/x-magento-init">
    {
        "*": {
            "Magento_Ui/js/core/app": {
                "components": {
                    "getresponse_tracking_code_section": {
                        "component": "GetResponse_GetResponseIntegration/js/getresponse_tracking_code_section"
                    }
                }
            }
        }
    }
</script>
